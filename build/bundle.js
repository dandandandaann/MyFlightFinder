var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function r(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function a(t,e){t.appendChild(e)}function l(t,e,n){t.insertBefore(e,n||null)}function s(t){t.parentNode.removeChild(t)}function c(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function d(t){return document.createElement(t)}function u(t){return document.createTextNode(t)}function h(){return u(" ")}function m(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function p(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function f(t,e,n,o){null===n?t.style.removeProperty(e):t.style.setProperty(e,n,o?"important":"")}function g(t,e){for(let n=0;n<t.options.length;n+=1){const o=t.options[n];if(o.__value===e)return void(o.selected=!0)}t.selectedIndex=-1}function y(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}let $;function b(t){$=t}function v(t){(function(){if(!$)throw new Error("Function called outside component initialization");return $})().$$.on_mount.push(t)}const x=[],w=[],L=[],_=[],C=Promise.resolve();let E=!1;function D(t){L.push(t)}const F=new Set;let T=0;function A(){const t=$;do{for(;T<x.length;){const t=x[T];T++,b(t),M(t.$$)}for(b(null),x.length=0,T=0;w.length;)w.pop()();for(let t=0;t<L.length;t+=1){const e=L[t];F.has(e)||(F.add(e),e())}L.length=0}while(x.length);for(;_.length;)_.pop()();E=!1,F.clear(),b(t)}function M(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(D)}}const S=new Set;function k(t,e){t&&t.i&&(S.delete(t),t.i(e))}function H(t,n,i,a){const{fragment:l,on_mount:s,on_destroy:c,after_update:d}=t.$$;l&&l.m(n,i),a||D((()=>{const n=s.map(e).filter(r);c?c.push(...n):o(n),t.$$.on_mount=[]})),d.forEach(D)}function R(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function B(t,e){-1===t.$$.dirty[0]&&(x.push(t),E||(E=!0,C.then(A)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function N(e,r,i,a,l,c,d,u=[-1]){const h=$;b(e);const m=e.$$={fragment:null,ctx:null,props:c,update:t,not_equal:l,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(r.context||(h?h.$$.context:[])),callbacks:n(),dirty:u,skip_bound:!1,root:r.target||h.$$.root};d&&d(m.root);let p=!1;if(m.ctx=i?i(e,r.props||{},((t,n,...o)=>{const r=o.length?o[0]:n;return m.ctx&&l(m.ctx[t],m.ctx[t]=r)&&(!m.skip_bound&&m.bound[t]&&m.bound[t](r),p&&B(e,t)),n})):[],m.update(),p=!0,o(m.before_update),m.fragment=!!a&&a(m.ctx),r.target){if(r.hydrate){const t=function(t){return Array.from(t.childNodes)}(r.target);m.fragment&&m.fragment.l(t),t.forEach(s)}else m.fragment&&m.fragment.c();r.intro&&k(e.$$.fragment),H(e,r.target,r.anchor,r.customElement),A()}b(h)}class j{$destroy(){R(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function I(t,e,n){e&&console.error(e),n&&console.dir(n),console.log("Error: "+t),alert("Error: "+t)}Date.prototype.monthDays=function(){return t=this.getMonth()+1,e=this.getFullYear(),new Date(e,t,0).getDate();var t,e};let P=["Domingo","Segunda","Terça","Quarta","Quinta","Sexta","Sábado"],q=[{value:0,text:"Janeiro"},{value:1,text:"Feveriro"},{value:2,text:"Março"},{value:3,text:"Abril"},{value:4,text:"Maio"},{value:5,text:"Junho"},{value:6,text:"Julho"},{value:7,text:"Agosto"},{value:8,text:"Setembro"},{value:9,text:"Outubro"},{value:10,text:"Novembro"},{value:11,text:"Dezembro"}],U=[2022,2023,2024,2025,2026,2027];class O extends class{constructor(t,e,n,o){this.origin=t,this.destination=e,this.month=n,this.year=o}fillCalendarFares(t,e){let n=e.monthDays();if(t.calendarDayList&&t.calendarDayList.length<n)I("Smiles não retornou tarifa para todos os dias do mês",null,t);else for(let o=1;o<=n;o++)if(t.calendarDayList[o-1]&&t.calendarDayList[o-1].miles){let n=document.getElementById("day"+o),r=n.getElementsByClassName("miles")[0],i=r.getElementsByClassName("smiles")[0],a=r.getElementsByClassName("currency")[0],l=t.calendarDayList[o-1].miles;if(a.innerText="milhas",i.innerText){let t=r.querySelector(".tooltiptext");t||(t=document.createElement("div"),t.classList.add("tooltiptext"),i.appendChild(t));let e=document.createElement("span");parseInt(i.innerText)<l?(e.innerText=i.innerText,i.innerText=l.toString()):e.innerText=l.toString(),t.appendChild(e),t.appendChild(document.createElement("br"))}else i.innerText=l.toString();t.calendarDayList[o-1].isLowestPrice&&i.classList.add("best-smiles"),n.setAttribute("onclick",`window.open('${this.dailyFareUrl(new Date(e.getFullYear(),e.getMonth(),o))}', \n                    '_blank');`)}}}{constructor(t,e,n,o){super(t,e,n,o),this.localResultUrl="./test-result.json"}searchFares(t=!1){let e=t?this.localResultUrl:this.monthlyFaresUrl(),n=new Date(this.year,this.month);fetch(e).then((async t=>(console.log("Http request ok."),await t.json()))).then((t=>{var e;if(0==t.hasCalendar||"ENABLED"!=t.calendarStatus||1!=(null===(e=t.calendarSegmentList)||void 0===e?void 0:e.length))return console.dir(t),void I("Não foi possível obter dados da smiles.");console.log("Json parse ok.");var o=t.calendarSegmentList[0];this.fillCalendarFares(o,n)})).catch((t=>I("Boo...\n"+t,t)))}monthlyFaresUrl(){let t=this.month+1,e=this.year;this.month>12&&(t=1,e+=1);let n=Intl.NumberFormat("pt-BR",{minimumIntegerDigits:2});return`https://api-air-calendar-prd.smiles.com.br/v1/airlines/calendar/month?originAirportCode=${this.origin}&destinationAirportCode=${this.destination}&startDate=${this.year}-${n.format(this.month)}-01&endDate=${e}-${n.format(t)}-01&departureDate=${this.year}-${n.format(this.month)}-01&adults=1&children=0&infants=0&forceCongener=false&cabin=ALL&bestFare=true&memberNumber=`}dailyFareUrl(t){return`https://www.smiles.com.br/emissao-com-milhas?tripType=2&isFlexibleDateChecked=false&cabin=ALL&adults=1&segments=1&children=0&infants=0&searchType=congenere&segments=1&originAirport=${this.origin}&destinationAirport=${this.destination}&departureDate=${new Date(t).getTime()}`}}function Y(e){let n,o,r;return{c(){n=d("div"),n.innerHTML='<h1 class="calendar-title"><a id="left" class="left-arrow">🡨</a> \n        <span id="month"></span> \n        <span id="year"></span> \n        <a id="right" class="right-arrow">🡪</a></h1>',o=h(),r=d("div"),r.innerHTML='<div class=""><table class="calendar-table"></table></div>',p(r,"class","")},m(t,e){l(t,n,e),l(t,o,e),l(t,r,e)},p:t,i:t,o:t,d(t){t&&s(n),t&&s(o),t&&s(r)}}}function G(t,e,n){v((async()=>{["localhost","127.0.0.1"].some((t=>window.location.href.includes(t)))&&n(0,c=!0),d()}));let o,r,{origin:i}=e,{destination:a}=e,{month:l}=e,{year:s}=e,{isRunningLocally:c}=e;function d(){!function(t){let e=[],n=/^[A-Z]+$/;i&&3==i.length&&n.test(i)||e.push("Aeroporto de origem não informado corretamente.");a&&3==a.length&&n.test(a)||e.push("Aeroporto de origem não informado corretamente.");if(t&&(null==e?void 0:e.some((t=>t))))return e.map((t=>console.warn(t))),alert(e.join(" ")),!1}(!0),u(new Date(s,l))}function u(t){o=t;let e=new Date(t.getFullYear(),t.getMonth()).getDay(),n=document.querySelector(".calendar-table"),r=document.querySelector(".calendar-table>tbody");r&&(n.innerHTML="");let i=document.createElement("tbody"),a=document.createElement("tr");P.map((t=>{let e=document.createElement("th");e.innerText=t,a.appendChild(e)})),i.appendChild(a),n.appendChild(i),r=document.createElement("tbody");let l=t.monthDays(),s=1;for(let t=1;t<=6;t++)if(!(s>l)){a=document.createElement("tr");for(let n=0;n<7;n++){let o=document.createElement("td");if(s>l)o.innerHTML="&nbsp;";else if(1===t&&n<e)o.innerHTML="&nbsp;";else{o.innerText=s.toString(),o.id="day"+s;let t=document.createElement("div"),e=document.createElement("span");e.classList.add("currency");let n=document.createElement("div");n.classList.add("smiles","tooltip"),t.classList.add("miles"),t.appendChild(n),t.appendChild(e),o.appendChild(t),o.classList.add("day"),s++}a.appendChild(o)}r.appendChild(a)}n.appendChild(r),document.getElementById("month").textContent=q[t.getMonth()].text,document.getElementById("year").textContent=t.getFullYear().toString()}return t.$$set=t=>{"origin"in t&&n(1,i=t.origin),"destination"in t&&n(2,a=t.destination),"month"in t&&n(3,l=t.month),"year"in t&&n(4,s=t.year),"isRunningLocally"in t&&n(0,c=t.isRunningLocally)},[c,i,a,l,s,d,function(t,e,n,c,d){var h,m;e=null!=e?e:i,n=null!=n?n:a,c=null!=c?c:l,d=null!=d?d:s,o.getFullYear()==d&&o.getMonth()==c||u(new Date(d,c));let p=!1;null!==(m=null===(h=document.getElementById("isTesting"))||void 0===h?void 0:h.checked)&&void 0!==m&&m&&(p=!0,console.warn("Reading from local json file")),r=new O(e,n,c,d),r.searchFares(p)}]}class J extends j{constructor(t){super(),N(this,t,G,Y,i,{origin:1,destination:2,month:3,year:4,isRunningLocally:0,Main:5,searchFares:6})}get Main(){return this.$$.ctx[5]}get searchFares(){return this.$$.ctx[6]}}function z(t,e,n){const o=t.slice();return o[8]=e[n],o}function Q(t,e,n){const o=t.slice();return o[11]=e[n],o}function V(e){let n,o,r,i,c=e[11].text+"";return{c(){n=d("option"),o=u(c),r=h(),n.__value=i=e[11].value,n.value=n.__value},m(t,e){l(t,n,e),a(n,o),a(n,r)},p:t,d(t){t&&s(n)}}}function Z(e){let n,o,r,i=e[8]+"";return{c(){n=d("option"),o=u(i),n.__value=r=e[8],n.value=n.__value},m(t,e){l(t,n,e),a(n,o)},p:t,d(t){t&&s(n)}}}function K(t){let e,n,o;return{c(){e=d("input"),n=u(" \r\n\t\t\t\t\t"),o=d("label"),o.textContent="Local only",p(e,"type","checkbox"),e.checked=!0,p(e,"id","isTesting"),p(o,"for","isTesting")},m(t,r){l(t,e,r),l(t,n,r),l(t,o,r)},d(t){t&&s(e),t&&s(n),t&&s(o)}}}function W(t){let e,n,i,y,$,b,v,x,L,C,E,F,T,A,M,B,N,j,I,P,O,Y,G,W,et,nt,ot,rt,it,at,lt,st,ct,dt,ut,ht,mt,pt,ft,gt,yt=q,$t=[];for(let e=0;e<yt.length;e+=1)$t[e]=V(Q(t,yt,e));let bt=U,vt=[];for(let e=0;e<bt.length;e+=1)vt[e]=Z(z(t,bt,e));let xt=t[3]&&K();function wt(e){t[7](e)}let Lt={origin:X,destination:tt,month:t[0],year:t[1]};return void 0!==t[3]&&(Lt.isRunningLocally=t[3]),dt=new J({props:Lt}),t[6](dt),w.push((()=>function(t,e,n){const o=t.$$.props[e];void 0!==o&&(t.$$.bound[o]=n,n(t.$$.ctx[o]))}(dt,"isRunningLocally",wt))),{c(){e=d("div"),n=d("header"),n.innerHTML='<h1>MyFlightFinder ✈️</h1> \n\t\t<p class="view"><a href="https://github.com/dandandandaann/MyFlightFinder">View the Project on GitHub</a></p> \n\t\t<ul><li><a href="https://github.com/dandandandaann/MyFlightFinder">View On <strong>GitHub</strong></a></li></ul>',i=h(),y=d("section"),$=d("div"),b=d("div"),v=u("Data:\r\n\t\t\t\t"),x=d("select");for(let t=0;t<$t.length;t+=1)$t[t].c();L=h(),C=d("select");for(let t=0;t<vt.length;t+=1)vt[t].c();var o;E=h(),F=d("br"),T=h(),A=d("label"),A.textContent="Aeroporto origem:",M=h(),B=d("input"),N=h(),j=d("br"),I=h(),P=d("label"),P.textContent="Aeroporto destino:",O=h(),Y=d("div"),Y.innerHTML='<input type="text" id="searchDestination" style="width: 200px;"/>',G=h(),W=d("input"),et=h(),nt=d("br"),ot=d("br"),rt=h(),it=d("button"),it.textContent="Pesquisar",at=h(),lt=d("br"),st=h(),xt&&xt.c(),ct=h(),(o=dt.$$.fragment)&&o.c(),ht=h(),mt=d("footer"),mt.innerHTML='<p>Project maintained by\n\t\t<a href="https://github.com/dandandandaann">dandandandaann</a></p> \n\t<p>Hosted on GitHub Pages — Theme by\n\t\t<a href="https://github.com/orderedlist">orderedlist</a></p>',p(n,"class","without-description"),f(x,"width","100px"),void 0===t[0]&&D((()=>t[4].call(x))),f(C,"width","100px"),void 0===t[1]&&D((()=>t[5].call(C))),p(A,"for","searchOrigin"),p(B,"type","text"),p(B,"maxlength","3"),p(B,"id","originAirportCode"),B.value=X,f(B,"width","80px"),p(P,"for","searchDestination"),f(Y,"display","none"),p(W,"type","text"),p(W,"maxlength","3"),p(W,"id","destinationAirportCode"),W.value=tt,f(W,"width","80px"),p(b,"class","input-settings"),p($,"id","calendar"),p(e,"class","wrapper")},m(o,s){l(o,e,s),a(e,n),a(e,i),a(e,y),a(y,$),a($,b),a(b,v),a(b,x);for(let t=0;t<$t.length;t+=1)$t[t].m(x,null);g(x,t[0]),a(b,L),a(b,C);for(let t=0;t<vt.length;t+=1)vt[t].m(C,null);g(C,t[1]),a(b,E),a(b,F),a(b,T),a(b,A),a(b,M),a(b,B),a(b,N),a(b,j),a(b,I),a(b,P),a(b,O),a(b,Y),a(b,G),a(b,W),a(b,et),a(b,nt),a(b,ot),a(b,rt),a(b,it),a(b,at),a(b,lt),a(b,st),xt&&xt.m(b,null),a($,ct),H(dt,$,null),l(o,ht,s),l(o,mt,s),pt=!0,ft||(gt=[m(x,"change",t[4]),m(C,"change",t[5]),m(it,"click",(function(){r(t[2].searchFares)&&t[2].searchFares.apply(this,arguments)}))],ft=!0)},p(e,[n]){if(t=e,0&n){let e;for(yt=q,e=0;e<yt.length;e+=1){const o=Q(t,yt,e);$t[e]?$t[e].p(o,n):($t[e]=V(o),$t[e].c(),$t[e].m(x,null))}for(;e<$t.length;e+=1)$t[e].d(1);$t.length=yt.length}if(1&n&&g(x,t[0]),0&n){let e;for(bt=U,e=0;e<bt.length;e+=1){const o=z(t,bt,e);vt[e]?vt[e].p(o,n):(vt[e]=Z(o),vt[e].c(),vt[e].m(C,null))}for(;e<vt.length;e+=1)vt[e].d(1);vt.length=bt.length}2&n&&g(C,t[1]),t[3]?xt||(xt=K(),xt.c(),xt.m(b,null)):xt&&(xt.d(1),xt=null);const o={};var r;1&n&&(o.month=t[0]),2&n&&(o.year=t[1]),!ut&&8&n&&(ut=!0,o.isRunningLocally=t[3],r=()=>ut=!1,_.push(r)),dt.$set(o)},i(t){pt||(k(dt.$$.fragment,t),pt=!0)},o(t){!function(t,e,n,o){if(t&&t.o){if(S.has(t))return;S.add(t),(void 0).c.push((()=>{S.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}}(dt.$$.fragment,t),pt=!1},d(n){n&&s(e),c($t,n),c(vt,n),xt&&xt.d(),t[6](null),R(dt),n&&s(ht),n&&s(mt),ft=!1,o(gt)}}}var X="GRU",tt="LIS";function et(t,e,n){var o=8,r=2022;let i,a=!1;return[o,r,i,a,function(){o=y(this),n(0,o)},function(){r=y(this),n(1,r)},function(t){w[t?"unshift":"push"]((()=>{i=t,n(2,i)}))},function(t){a=t,n(3,a)}]}return new class extends j{constructor(t){super(),N(this,t,et,W,i,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
